{"version":3,"file":"storage.mjs","sources":["../../node_modules/@mastra/core/dist/chunk-SJMKDSRF.js"],"sourcesContent":["// src/storage/constants.ts\nvar TABLE_WORKFLOW_SNAPSHOT = \"mastra_workflow_snapshot\";\nvar TABLE_EVALS = \"mastra_evals\";\nvar TABLE_MESSAGES = \"mastra_messages\";\nvar TABLE_THREADS = \"mastra_threads\";\nvar TABLE_TRACES = \"mastra_traces\";\nvar TABLE_RESOURCES = \"mastra_resources\";\nvar TABLE_SCORERS = \"mastra_scorers\";\nvar TABLE_AI_SPANS = \"mastra_ai_spans\";\nvar SCORERS_SCHEMA = {\n  id: { type: \"text\", nullable: false, primaryKey: true },\n  scorerId: { type: \"text\" },\n  traceId: { type: \"text\", nullable: true },\n  spanId: { type: \"text\", nullable: true },\n  runId: { type: \"text\" },\n  scorer: { type: \"jsonb\" },\n  preprocessStepResult: { type: \"jsonb\", nullable: true },\n  extractStepResult: { type: \"jsonb\", nullable: true },\n  analyzeStepResult: { type: \"jsonb\", nullable: true },\n  score: { type: \"float\" },\n  reason: { type: \"text\", nullable: true },\n  metadata: { type: \"jsonb\", nullable: true },\n  preprocessPrompt: { type: \"text\", nullable: true },\n  extractPrompt: { type: \"text\", nullable: true },\n  generateScorePrompt: { type: \"text\", nullable: true },\n  generateReasonPrompt: { type: \"text\", nullable: true },\n  analyzePrompt: { type: \"text\", nullable: true },\n  // Deprecated\n  reasonPrompt: { type: \"text\", nullable: true },\n  input: { type: \"jsonb\" },\n  output: { type: \"jsonb\" },\n  // MESSAGE OUTPUT\n  additionalContext: { type: \"jsonb\", nullable: true },\n  // DATA FROM THE CONTEXT PARAM ON AN AGENT\n  runtimeContext: { type: \"jsonb\", nullable: true },\n  // THE EVALUATE RUNTIME CONTEXT FOR THE RUN\n  /**\n   * Things you can evaluate\n   */\n  entityType: { type: \"text\", nullable: true },\n  // WORKFLOW, AGENT, TOOL, STEP, NETWORK\n  entity: { type: \"jsonb\", nullable: true },\n  // MINIMAL JSON DATA ABOUT WORKFLOW, AGENT, TOOL, STEP, NETWORK\n  entityId: { type: \"text\", nullable: true },\n  source: { type: \"text\" },\n  resourceId: { type: \"text\", nullable: true },\n  threadId: { type: \"text\", nullable: true },\n  createdAt: { type: \"timestamp\" },\n  updatedAt: { type: \"timestamp\" }\n};\nvar AI_SPAN_SCHEMA = {\n  // Composite primary key of traceId and spanId\n  traceId: { type: \"text\", nullable: false },\n  spanId: { type: \"text\", nullable: false },\n  parentSpanId: { type: \"text\", nullable: true },\n  name: { type: \"text\", nullable: false },\n  scope: { type: \"jsonb\", nullable: true },\n  // Mastra package info {\"core-version\": \"0.1.0\"}\n  spanType: { type: \"text\", nullable: false },\n  // WORKFLOW_RUN, WORKFLOW_STEP, AGENT_RUN, AGENT_STEP, TOOL_RUN, TOOL_STEP, etc.\n  attributes: { type: \"jsonb\", nullable: true },\n  metadata: { type: \"jsonb\", nullable: true },\n  links: { type: \"jsonb\", nullable: true },\n  input: { type: \"jsonb\", nullable: true },\n  output: { type: \"jsonb\", nullable: true },\n  error: { type: \"jsonb\", nullable: true },\n  startedAt: { type: \"timestamp\", nullable: false },\n  // When the span started\n  endedAt: { type: \"timestamp\", nullable: true },\n  // When the span ended\n  createdAt: { type: \"timestamp\", nullable: false },\n  // The time the database record was created\n  updatedAt: { type: \"timestamp\", nullable: true },\n  // The time the database record was last updated\n  isEvent: { type: \"boolean\", nullable: false }\n};\nvar TABLE_SCHEMAS = {\n  [TABLE_WORKFLOW_SNAPSHOT]: {\n    workflow_name: {\n      type: \"text\"\n    },\n    run_id: {\n      type: \"text\"\n    },\n    resourceId: { type: \"text\", nullable: true },\n    snapshot: {\n      type: \"text\"\n    },\n    createdAt: {\n      type: \"timestamp\"\n    },\n    updatedAt: {\n      type: \"timestamp\"\n    }\n  },\n  [TABLE_SCORERS]: SCORERS_SCHEMA,\n  [TABLE_EVALS]: {\n    input: {\n      type: \"text\"\n    },\n    output: {\n      type: \"text\"\n    },\n    result: {\n      type: \"jsonb\"\n    },\n    agent_name: {\n      type: \"text\"\n    },\n    metric_name: {\n      type: \"text\"\n    },\n    instructions: {\n      type: \"text\"\n    },\n    test_info: {\n      type: \"jsonb\",\n      nullable: true\n    },\n    global_run_id: {\n      type: \"text\"\n    },\n    run_id: {\n      type: \"text\"\n    },\n    created_at: {\n      type: \"timestamp\"\n    },\n    createdAt: {\n      type: \"timestamp\",\n      nullable: true\n    }\n  },\n  [TABLE_THREADS]: {\n    id: { type: \"text\", nullable: false, primaryKey: true },\n    resourceId: { type: \"text\", nullable: false },\n    title: { type: \"text\", nullable: false },\n    metadata: { type: \"text\", nullable: true },\n    createdAt: { type: \"timestamp\", nullable: false },\n    updatedAt: { type: \"timestamp\", nullable: false }\n  },\n  [TABLE_MESSAGES]: {\n    id: { type: \"text\", nullable: false, primaryKey: true },\n    thread_id: { type: \"text\", nullable: false },\n    content: { type: \"text\", nullable: false },\n    role: { type: \"text\", nullable: false },\n    type: { type: \"text\", nullable: false },\n    createdAt: { type: \"timestamp\", nullable: false },\n    resourceId: { type: \"text\", nullable: true }\n  },\n  [TABLE_AI_SPANS]: AI_SPAN_SCHEMA,\n  [TABLE_TRACES]: {\n    id: { type: \"text\", nullable: false, primaryKey: true },\n    parentSpanId: { type: \"text\", nullable: true },\n    name: { type: \"text\", nullable: false },\n    traceId: { type: \"text\", nullable: false },\n    scope: { type: \"text\", nullable: false },\n    kind: { type: \"integer\", nullable: false },\n    attributes: { type: \"jsonb\", nullable: true },\n    status: { type: \"jsonb\", nullable: true },\n    events: { type: \"jsonb\", nullable: true },\n    links: { type: \"jsonb\", nullable: true },\n    other: { type: \"text\", nullable: true },\n    startTime: { type: \"bigint\", nullable: false },\n    endTime: { type: \"bigint\", nullable: false },\n    createdAt: { type: \"timestamp\", nullable: false }\n  },\n  [TABLE_RESOURCES]: {\n    id: { type: \"text\", nullable: false, primaryKey: true },\n    workingMemory: { type: \"text\", nullable: true },\n    metadata: { type: \"jsonb\", nullable: true },\n    createdAt: { type: \"timestamp\", nullable: false },\n    updatedAt: { type: \"timestamp\", nullable: false }\n  }\n};\n\nexport { AI_SPAN_SCHEMA, SCORERS_SCHEMA, TABLE_AI_SPANS, TABLE_EVALS, TABLE_MESSAGES, TABLE_RESOURCES, TABLE_SCHEMAS, TABLE_SCORERS, TABLE_THREADS, TABLE_TRACES, TABLE_WORKFLOW_SNAPSHOT };\n//# sourceMappingURL=chunk-SJMKDSRF.js.map\n//# sourceMappingURL=chunk-SJMKDSRF.js.map"],"names":[],"mappings":"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","x_google_ignoreList":[0]}